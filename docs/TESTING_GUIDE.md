# 需求分析功能测试使用指引

## 📋 概述

本文档提供需求分析新功能的详细测试指引，帮助测试人员快速上手并全面测试向导式需求分析流程。

## 🎯 功能概览

### 新功能特性

1. **向导式需求分析**：通过5个问题快速完成需求分析
   - 问题1：产品描述（文本输入）
   - 问题2：风格选择（多选卡片）
   - 问题3：卖点选择（多选标签）
   - 问题4-5：智能追问（根据前3个问题动态生成，最多2个）

2. **文本输入模式**：保留原有功能，向后兼容

3. **自动规划生成**：需求分析完成后自动生成内容规划

4. **规划确认**：支持查看和确认生成的内容规划

## 🚀 快速开始

### 访问路径

1. 从首页点击"需求分析"按钮
2. 或直接访问：`/plan/requirement`

### 测试环境准备

1. 确保已配置API密钥（DeepSeek和Google GenAI）
2. 或启用模拟模式（Mock Mode）进行测试

## 📝 测试步骤

### 测试场景1：向导式需求分析（完整流程）

#### 步骤1：进入需求分析页面

1. 访问 `/plan/requirement`
2. 应该看到模式选择界面，显示两个选项：
   - ✨ 向导式分析（推荐）
   - 📝 文本输入

#### 步骤2：选择向导式分析

1. 点击"向导式分析"卡片
2. 应该进入向导界面，显示：
   - 步骤指示器（显示当前步骤/总步骤）
   - 进度条
   - 问题标题和输入区域

#### 步骤3：回答问题1 - 产品描述

**测试用例：**

- ✅ **正常输入**：
  - 输入："这是一款面向18-25岁女性的高品质智能手表"
  - 验证：可以正常输入，显示字符数
  - 点击"下一步"应该成功

- ✅ **空输入验证**：
  - 不输入任何内容，直接点击"下一步"
  - 验证：显示错误提示"请输入产品描述"

- ✅ **长度验证**：
  - 输入少于5个字符（如："手表"）
  - 验证：显示错误提示"产品描述至少需要5个字符"

- ✅ **特殊字符**：
  - 输入包含emoji、标点符号的内容
  - 验证：可以正常保存

#### 步骤4：回答问题2 - 风格选择

**测试用例：**

- ✅ **多选功能**：
  - 点击多个风格卡片（如：小红书、INS极简、科技未来）
  - 验证：选中的卡片有视觉反馈（选中徽章、边框高亮）
  - 验证：可以取消选择（除了最后一个）

- ✅ **最小选择限制**：
  - 只选择一个风格，尝试取消选择
  - 验证：无法取消，保持选中状态

- ✅ **选择数量**：
  - 选择1个、2个、3个或更多风格
  - 验证：所有选择都能正确保存

- ✅ **响应式布局**：
  - 在不同屏幕尺寸下测试（桌面、平板、手机）
  - 验证：网格布局自适应

#### 步骤5：回答问题3 - 卖点选择

**测试用例：**

- ✅ **预设卖点选择**：
  - 选择多个预设卖点（如：性价比、品质、颜值）
  - 验证：标签选中状态正确显示

- ✅ **自定义卖点**（如果启用）：
  - 在自定义输入框输入新卖点（如："环保"）
  - 点击"添加"按钮
  - 验证：新卖点出现在标签列表中
  - 验证：新卖点自动被选中

- ✅ **删除自定义卖点**：
  - 点击自定义卖点的"×"按钮
  - 验证：卖点被移除
  - 验证：如果该卖点被选中，也从选中列表中移除

#### 步骤6：智能追问（问题4-5）

**测试场景：**

- ✅ **触发追问**：
  - 产品描述不包含目标受众信息
  - 验证：显示追问"请描述您的目标受众"

- ✅ **不触发追问**：
  - 产品描述包含完整信息（如："面向18-25岁女性的口红产品，每周发布2-3篇"）
  - 验证：不显示追问，直接进入完成状态

- ✅ **最多2个追问**：
  - 确保即使需要更多信息，也最多只显示2个追问

- ✅ **跳过追问**：
  - 对于非必需问题，可以跳过
  - 验证：可以继续下一步

#### 步骤7：完成需求分析

1. 回答完所有问题后，点击"完成"按钮
2. 验证：
   - 显示完成动画
   - 显示需求摘要
   - 自动生成内容规划
   - 弹出规划确认弹窗

#### 步骤8：规划确认

**测试用例：**

- ✅ **查看规划详情**：
  - 验证：显示规划名称、内容数量、规划周期
  - 验证：显示内容列表
  - 验证：显示策略分析（多样性评分等）

- ✅ **确认规划**：
  - 点击"确认规划"按钮
  - 验证：规划状态更新为"已确认"
  - 验证：跳转到规划页面（`/plan/content?planId=xxx`）

- ✅ **编辑规划**：
  - 点击"编辑"按钮
  - 验证：跳转到规划编辑页面

- ✅ **取消操作**：
  - 点击"取消"或关闭按钮
  - 验证：弹窗关闭，停留在需求分析页面

### 测试场景2：文本输入模式（向后兼容）

#### 步骤1：选择文本输入模式

1. 在模式选择界面点击"文本输入"卡片
2. 验证：显示文本输入框

#### 步骤2：输入需求描述

**测试用例：**

- ✅ **正常输入**：
  - 输入："推广新款口红，目标用户是18-25岁女性，希望生成教程类内容"
  - 点击"开始分析"
  - 验证：显示分析结果

- ✅ **空输入验证**：
  - 不输入内容，点击"开始分析"
  - 验证：按钮禁用，无法点击

- ✅ **分析结果**：
  - 验证：显示提取的主题
  - 验证：显示目标受众信息
  - 验证：显示推荐风格
  - 验证：显示关键词

#### 步骤3：查看历史需求

1. 完成分析后，返回需求分析页面
2. 验证：历史需求列表中显示刚才的分析
3. 验证：显示分析时间、内容类型等信息

### 测试场景3：历史需求管理

#### 步骤1：查看历史需求

1. 在需求分析页面下方查看历史需求列表
2. 验证：
   - 显示所有历史需求
   - 显示需求主题/产品描述
   - 显示内容类型
   - 显示创建时间
   - 向导式需求显示"向导式"徽章

#### 步骤2：选择历史需求

1. 点击历史需求卡片
2. 验证：
   - 如果是向导式需求，恢复向导状态并显示已填写的答案
   - 如果是文本输入，显示原始输入文本
   - 显示分析结果

#### 步骤3：继续编辑

1. 选择历史需求后，可以继续编辑
2. 验证：可以修改答案并重新分析

### 测试场景4：错误处理

#### 测试用例：

- ✅ **网络错误**：
  - 断开网络连接
  - 尝试进行分析
  - 验证：显示友好的错误提示

- ✅ **API错误**：
  - 配置错误的API密钥
  - 尝试进行分析
  - 验证：显示具体的错误信息

- ✅ **数据验证错误**：
  - 输入不符合要求的数据
  - 验证：显示清晰的验证错误提示

- ✅ **中途退出**：
  - 在向导过程中刷新页面或关闭浏览器
  - 验证：数据是否保存（如果实现了自动保存）

## 🔍 详细测试检查点

### UI/UX测试

- [ ] 步骤指示器正确显示当前步骤
- [ ] 进度条平滑更新
- [ ] 按钮状态正确（禁用/启用）
- [ ] 错误提示清晰明确
- [ ] 加载状态正确显示
- [ ] 动画效果流畅
- [ ] 响应式布局在不同设备上正常

### 功能测试

- [ ] 所有问题都能正确回答
- [ ] 答案验证逻辑正确
- [ ] 最小选择限制生效
- [ ] 智能追问逻辑正确触发
- [ ] 数据正确保存到localStorage
- [ ] 规划生成成功
- [ ] 规划确认功能正常

### 兼容性测试

- [ ] 向导式模式和文本输入模式可以切换
- [ ] 旧版文本输入功能完全兼容
- [ ] 历史需求可以正常查看和编辑

### 性能测试

- [ ] 页面加载速度
- [ ] 问题切换响应速度
- [ ] 规划生成速度
- [ ] 大量历史需求的渲染性能

## 🐛 已知问题和注意事项

### 注意事项

1. **企业微信通知**：接口已搭建，但需要配置Webhook URL才能使用
2. **内容生产**：需要确认规划后才能开始生产
3. **日历同步**：需要规划确认后才会同步到发布日历

### 测试建议

1. **完整流程测试**：建议至少完成一次完整的向导式流程
2. **边界测试**：测试各种边界情况（空输入、超长输入、特殊字符等）
3. **兼容性测试**：确保新旧功能都能正常工作
4. **数据持久化**：验证数据是否正确保存和恢复

## 📊 测试报告模板

### 测试环境

- 浏览器：Chrome 120+
- 操作系统：Windows 10/11
- 测试日期：YYYY-MM-DD
- 测试人员：XXX

### 测试结果

| 测试场景 | 测试用例 | 结果 | 备注 |
|---------|---------|------|------|
| 向导式流程 | 完整流程 | ✅/❌ | |
| 文本输入 | 向后兼容 | ✅/❌ | |
| 历史需求 | 查看和编辑 | ✅/❌ | |
| 错误处理 | 各种错误场景 | ✅/❌ | |

### 发现的问题

1. **问题描述**：[详细描述]
   - **严重程度**：高/中/低
   - **复现步骤**：[步骤]
   - **预期结果**：[预期]
   - **实际结果**：[实际]

## 🎉 测试完成标准

- [ ] 所有核心功能测试通过
- [ ] 所有边界情况测试通过
- [ ] UI/UX测试通过
- [ ] 兼容性测试通过
- [ ] 性能测试满足要求
- [ ] 无严重bug（阻塞性问题）

---

**测试完成后，请将测试报告反馈给开发团队。**

